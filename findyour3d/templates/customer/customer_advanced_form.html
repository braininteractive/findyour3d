{% extends 'base_form.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block title %}Wizard {% endblock title %}

{% block extra_css %}
{#    <link href="{% static 'forms/js/bootstrap-fileinput/bootstrap-fileinput.css'%}"#}
{#          rel="stylesheet"  type="text/css" />#}
{#    <link href="{% static 'forms/select2/css/select2.min.css' %}" rel="stylesheet" type="text/css" />#}
{% endblock extra_css %}

{% block content %}

    <div class="container">
        {% if form.errors %}
            <div class="alert alert-danger">
                {{ form.errors }}
            </div>
        {% endif %}

        <div class="row">
            <div class="col-md-9 col-md-offset-2">
                <form action="" method="post">{% csrf_token %}
                    <div class="form-actions">
                        <div class="row">
                            {{ form|crispy }}
                            <button type="submit" class="btn btn-outline blue button-next" id="save"> Submit
                                <i class="fa fa-check"></i>
                            </button>
                            {% if back_button %}
                                <a href="{% url 'dashboard:company' %}" class="btn btn-default button-next">
                                    <i class="fa fa-times"></i> Cancel</a>
                            {% endif %}
                        </div>
                    </div>
                </form>

            </div>
        </div>

    </div>
{% endblock content %}

{% block extra_js %}
    {#    <script src="{% static 'forms/js/bootstrap-fileinput/bootstrap-fileinput.js' %}"></script>#}
    {#    <script src="{% static 'forms/js/jquery-validation/js/jquery.validate.min.js' %}" type="text/javascript"></script>#}
    {#    <script src="{% static 'forms/js/jquery-validation/js/additional-methods.min.js' %}" type="text/javascript"></script>#}
    {#    <script src="{% static 'forms/js/bootstrap-wizard/jquery.bootstrap.wizard.min.js' %}" type="text/javascript"></script>#}
    {#    <script src="{% static 'forms/select2/js/select2.full.min.js' %}" type="text/javascript"></script>#}
    {#    <script src="{% static 'forms/js/app.js' %}" type="text/javascript"></script>#}
    {#    <script src="{% static 'forms/js/form-wizard.min.js' %}" type="text/javascript"></script>#}

    <script>
        var saveButton = $('#save');

        var basicMaterial = $('#id_basic_material');
        var preciousMetal = $('#id_is_precious_metal');
        var metalConcern = $('#id_metal_concern');
        var metalDecision = $('#id_metal_decision');
        var otherMaterials = $('#id_other_materials');
        var plasticConcern = $('#id_plastic_concern');
        var foodSafePlastic = $('#id_is_food_safe_plastic');
        var plasticDecision = $('#id_plastic_decision');
        var heatResistance = $('#id_heat_resistance');
        var extremeStrength = $('#id_is_extreme_strength');
        var highestDetail = $('#id_is_highest_detail');
        var functionalOrBasic = $('#id_is_functional_or_basic');
        var ableToBend = $('#id_is_able_to_bend');
        var betterAppearance = $('#id_is_better_appearance');
        var fullColor = $('#id_is_full_color');

        var preciousMetalBlock = $('#div_id_is_precious_metal');
        var metalConcernBlock = $('#div_id_metal_concern');
        var metalDecisionBlock = $('#div_id_metal_decision');
        var otherMaterialsBlock = $('#div_id_other_materials');
        var plasticConcernBlock = $('#div_id_plastic_concern');
        var foodSafePlasticBlock = $('#div_id_is_food_safe_plastic');
        var functionalOrBasicBlock = $('#div_id_is_functional_or_basic');
        var plasticDecisionBlock = $('#div_id_plastic_decision');
        var heatResistanceBlock = $('#div_id_heat_resistance');
        var extremeStrengthBlock = $('#div_id_is_extreme_strength');
        var betterAppearanceBlock = $('#div_id_is_better_appearance');
        var highestDetailBlock = $('#div_id_is_highest_detail');
        var fullColorBlock = $('#div_id_is_full_color');
        var ableToBendBlock = $('#div_id_is_able_to_bend');

        var all = [saveButton, preciousMetalBlock, metalConcernBlock, metalDecisionBlock, otherMaterialsBlock,
            plasticConcernBlock, foodSafePlasticBlock, functionalOrBasicBlock, plasticDecisionBlock,
            heatResistanceBlock, extremeStrengthBlock, betterAppearanceBlock, highestDetailBlock,
            fullColorBlock, ableToBendBlock];

        $.each(all, function(){ $(this).hide()});

        basicMaterial.on('click', function () {
            $('[name=basic_material]').val(0);
        });

        basicMaterial.on('change', function () {
            basicMaterial.attr('readonly', true);
            basicMaterial.prop('disabled', true);
            console.log(basicMaterial.val());


            $('#div_id_basic_material').append('<small> <a onclick="location.reload()">Change basic material</a> </small>');
            // metals
            if (this.value==1){
                preciousMetalBlock.show();
                preciousMetal.on('change', function () {
                    saveButton.hide();
                    if (this.value==3){
                        metalConcernBlock.show();
                        metalConcern.on('change', function () {
                            saveButton.hide();
                            if (this.value==2){ // conductivity
                                metalDecisionBlock.show();
                                metalDecision.on('change', function () {
                                    saveButton.show();
                                    if (this.value==0){
                                        saveButton.hide()
                                    }
                                })
                            }
                            if (this.value==1){
                                metalDecisionBlock.hide();
                                metalDecision.val(0);
{#                                metalConcernBlock.show();#}
{#                                metalConcern.val(0);#}

                                saveButton.show();
                            }
                            if (this.value==0){
                                metalDecisionBlock.hide();
                                metalDecision.val(0);

                                saveButton.hide();
                            }
                        })
                    }
                    if (this.value==2){
                        saveButton.show()
                    }
                })
            }
            // other
            if (this.value==3){
                otherMaterialsBlock.show();
                otherMaterials.on('change', function () {
                    saveButton.show();
                })
            }
            // resin
            if (this.value==0){
                plasticConcernBlock.show();
                plasticConcern.on('change', function () {
                    saveButton.hide();
                    highestDetailBlock.hide();
                    highestDetail.val(0);
                    ableToBendBlock.hide();
                    ableToBend.val(0);
                    extremeStrengthBlock.hide();
                    extremeStrength.val(0);

                    if (this.value==1){ // cost
                        heatResistanceBlock.hide();
                        heatResistance.val(0);

                        foodSafePlasticBlock.show();
                        foodSafePlastic.on('change', function () {
                            saveButton.hide();
                            if (this.value==2){
                                plasticDecisionBlock.hide();
                                plasticDecision.val(0);

                                functionalOrBasicBlock.show();
                                functionalOrBasic.on('change', function () {
                                    saveButton.show();
                                    if (this.value==0){
                                        saveButton.hide();
                                    }
                                })
                            }
                            if (this.value==3){
                                functionalOrBasicBlock.hide();
                                functionalOrBasic.val(0);

                                plasticDecisionBlock.show();
                                plasticDecision.on('change', function () {
                                    saveButton.show();
                                    if (this.value==0){
                                        saveButton.hide();
                                    }

                                })
                            }
                            if (this.value==1){
                                plasticDecisionBlock.hide();
                                plasticDecision.val(0);
                                functionalOrBasicBlock.hide();
                                functionalOrBasic.val(0);
                            }
                        })
                    }
                    if (this.value==2){ // quality
                        foodSafePlasticBlock.hide();
                        foodSafePlastic.val(0);
                        functionalOrBasicBlock.hide();
                        functionalOrBasic.val(0);
                        plasticDecisionBlock.hide();
                        plasticDecision.val(0);

                        heatResistanceBlock.show();
                        heatResistance.on('change', function () {
                            saveButton.hide();
                            betterAppearanceBlock.hide();
                            betterAppearance.val(0);
                            ableToBendBlock.hide();
                            ableToBend.val(0);

                            if (this.value==1){ // able
                                highestDetailBlock.hide();
                                highestDetail.val(0);
                                ableToBendBlock.hide();
                                ableToBend.val(0);

                                extremeStrengthBlock.show();
                                extremeStrength.on('change', function () {
                                    saveButton.hide();
                                    if (this.value==3){
                                        betterAppearanceBlock.show();
                                        betterAppearance.on('change', function () {
                                            saveButton.show();
                                            if (this.value==1){
                                                saveButton.hide();
                                            }
                                        })
                                    }
                                    if (this.value==2){
                                        betterAppearanceBlock.hide();
                                        betterAppearance.val(0);
                                        saveButton.show();
                                    }
                                })
                            }
                            if (this.value==2){ // neither
                                extremeStrengthBlock.hide();
                                extremeStrength.val(0);
                                ableToBend.val(0);

                                highestDetailBlock.show();
                                highestDetail.on('change', function () {
                                    fullColorBlock.hide();
                                    fullColor.val(0);
                                    saveButton.hide();

                                    if (this.value==2){
                                        fullColorBlock.show();
                                        fullColor.on('change', function () {
                                            saveButton.show();
                                            if (this.value==1){
                                                saveButton.hide();
                                            }
                                        })
                                    }
                                    if (this.value==3){
                                        saveButton.show();
                                    }
                                })
                            }
                            if (this.value==3){ // flexible
                                highestDetailBlock.hide();
                                highestDetail.val(0);
                                extremeStrengthBlock.hide();
                                extremeStrength.val(0);

                                ableToBendBlock.show();
                                ableToBend.on('change', function () {
                                    saveButton.show();
                                    if (this.value==1){
                                        saveButton.hide();
                                    }
                                })
                            }
                            if (this.value==0){
                                console.log('close heat');
                                highestDetailBlock.hide();
                                highestDetail.val(0);
                                ableToBendBlock.hide();
                                ableToBend.val(0);
                                extremeStrengthBlock.hide();
                                extremeStrength.val(0);
                                fullColorBlock.hide();
                                fullColor.val(0);
                                plasticDecisionBlock.hide();
                                plasticDecision.val(0);
                            }
                        })
                    }
                    if (this.value==0){
                        console.log('close child');
                        heatResistanceBlock.hide();
                        heatResistance.val(0);
                        highestDetailBlock.hide();
                        highestDetail.val(0);
                        ableToBendBlock.hide();
                        ableToBend.val(0);
                        extremeStrengthBlock.hide();
                        extremeStrength.val(0);
                        fullColorBlock.hide();
                        fullColor.val(0);
                        plasticDecisionBlock.hide();
                        plasticDecision.val(0);
                        foodSafePlasticBlock.hide();
                        foodSafePlastic.val(0);
                        functionalOrBasicBlock.hide();
                        functionalOrBasic.val(0);
                    }
                })
            }
        });
        $('form').submit(function(e) {
            $(':disabled').each(function(e) {
                $(this).removeAttr('disabled');
            })
        });

    </script>


{% endblock extra_js %}
